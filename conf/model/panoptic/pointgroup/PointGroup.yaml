# @package model
defaults:
  - /model/panoptic/default

class: pointgroup.PointGroup
conv_type: "SPARSE"
scorer_type: "unet"
loss_weights:
  semantic: 1
  offset_norm_loss: 1
  offset_dir_loss: 1
  score_loss: 1
backbone:
  architecture: "unet"

scorer_unet:
  class: minkowski.Minkowski_Model
  conv_type: "SPARSE"
  define_constants:
    in_feat: 96
  down_conv:
    module_name: ResNetDown
    dimension: 3
    down_conv_nn: [ [ in_feat, 2*in_feat ], [ 2*in_feat, 4*in_feat ] ]
    kernel_size: 3
    stride: 2
    N: 1
  up_conv:
    module_name: ResNetUp
    dimension: 3
    up_conv_nn:
      [ [ 4*in_feat, 2*in_feat ], [ 2*in_feat+ 2*in_feat, in_feat ] ]
    kernel_size: 3
    stride: 2
    N: 1
scorer_encoder:
  class: minkowski.Minkowski_Model
  conv_type: "SPARSE"
  define_constants:
    in_feat: 96
  down_conv:
    module_name: ResNetDown
    dimension: 3
    down_conv_nn: [ [ in_feat, 2*in_feat ], [ 2*in_feat, 4*in_feat ] ]
    kernel_size: 3
    stride: 2
    N: 1
  innermost:
    module_name: GlobalBaseModule
    activation:
      name: LeakyReLU
      negative_slope: 0.2
    aggr: "max"
    nn: [ 4*in_feat, in_feat ]

prepare_epoch: 120
cluster_radius_search: 1.5 * ${data.first_subsampling}

min_iou_threshold: 0.25
max_iou_threshold: 0.75

vizual_ratio: 0
